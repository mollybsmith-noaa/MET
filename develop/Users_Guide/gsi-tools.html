

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>11. GSI Tools &mdash; MET develop documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://jprestop.github.io/VersionTest/latest/Users_Guide/gsi-tools.html"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="MET develop documentation" href="../index.html"/>
        <link rel="up" title="User’s Guide" href="index.html"/>
        <link rel="next" title="12. Stat-Analysis Tool" href="stat-analysis.html"/>
        <link rel="prev" title="10. Wavelet-Stat Tool" href="wavelet-stat.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> MET
          

          
            
            <img src="../_static/met_logo_2019_09.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                
                  <div class="version-dropdown">
                    <select class="version-list" id="version-list">
                      <option value=''>develop</option>
                      
                        
                          <option value="../latest">latest</option>
                        
                      
                        
                      
                    </select>
                  </div>
                
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Model Evaluation Tools</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">User’s Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="overview.html">1. Overview of MET</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html">2. Software Installation/Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_io.html">3. MET Data I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="reformat_point.html">4. Re-Formatting of Point Observations</a></li>
<li class="toctree-l2"><a class="reference internal" href="reformat_grid.html">5. Re-Formatting of Gridded Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="masking.html">6. Regional Verification using Spatial Masking</a></li>
<li class="toctree-l2"><a class="reference internal" href="point-stat.html">7. Point-Stat Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="grid-stat.html">8. Grid-Stat Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="ensemble-stat.html">9. Ensemble-Stat Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="wavelet-stat.html">10. Wavelet-Stat Tool</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">11. GSI Tools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#gsid2mpr-tool">11.1. GSID2MPR tool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gsid2mpr-usage">11.1.1. gsid2mpr usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gsid2mpr-output">11.1.2. gsid2mpr output</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#gsidens2orank-tool">11.2. GSIDENS2ORANK tool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gsidens2orank-usage">11.2.1. gsidens2orank usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#gsidens2orank-output">11.2.2. gsidens2orank output</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stat-analysis.html">12. Stat-Analysis Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="series-analysis.html">13. Series-Analysis Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="grid-diag.html">14. Grid-Diag Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="mode.html">15. MODE Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="mode-analysis.html">16. MODE-Analysis Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="mode-td.html">17. MODE Time Domain Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="met-tc_overview.html">18. MET-TC Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="tc-dland.html">19. TC-Dland Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="tc-pairs.html">20. TC-Pairs Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="tc-stat.html">21. TC-Stat Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="tc-gen.html">22. TC-Gen Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="tc-rmw.html">23. TC-RMW Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="rmw-analysis.html">24. RMW-Analysis Tool</a></li>
<li class="toctree-l2"><a class="reference internal" href="plotting.html">25. Plotting and Graphics Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="refs.html">26. References</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendixA.html">27. Appendix A FAQs &amp; How do I … ?</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendixB.html">28. Appendix B Map Projections, Grids, and Polylines</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendixC.html">29. Appendix C Verification Measures</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendixD.html">30. Appendix D Confidence Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendixE.html">31. Appendix E WWMCA Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendixF.html">32. Appendix F Python Embedding</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendixG.html">33. Appendix G Vectors and Vector Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#indices-and-tables">Indices and tables</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Contributors_Guide/index.html">Contributor’s Guide</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MET</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">User’s Guide</a> &raquo;</li>
        
      <li><span class="section-number">11. </span>GSI Tools</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/Users_Guide/gsi-tools.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="gsi-tools">
<span id="id1"></span><h1><span class="section-number">11. </span>GSI Tools<a class="headerlink" href="#gsi-tools" title="Permalink to this headline">¶</a></h1>
<p>Gridpoint Statistical Interpolation (GSI) diagnostic files are binary files written out from the data assimilation code before the first and after each outer loop. The files contain useful information about how a single observation was used in the analysis by providing details such as the innovation (O-B), observation values, observation error, adjusted observation error, and quality control information.</p>
<p>For more detail on generating GSI diagnostic files and their contents, see the <a class="reference external" href="http://www.dtcenter.org/com-GSI/users/docs/index.php">GSI User’s Guide.</a></p>
<p>When MET reads GSI diagnostic files, the innovation (O-B; generated prior to the first outer loop) or analysis increment (O-A; generated after the final outer loop) is split into separate values for the observation (OBS) and the forecast (FCST), where the forecast value corresponds to the background (O-B) or analysis (O-A).</p>
<p>MET includes two tools for processing GSI diagnostic files. The gsid2mpr tool reformats individual GSI diagnostic files into the MET matched pair (MPR) format, similar to the output of the Point-Stat tool. The gsidens2orank tool processes an ensemble of GSI diagnostic files and reformats them into the MET observation rank (ORANK) line type, similar to the output of the Ensemble-Stat tool. The output of both tools may be passed to the Stat-Analysis tool to compute a wide variety of continuous, categorical, and ensemble statistics.</p>
<div class="section" id="gsid2mpr-tool">
<h2><span class="section-number">11.1. </span>GSID2MPR tool<a class="headerlink" href="#gsid2mpr-tool" title="Permalink to this headline">¶</a></h2>
<p>This section describes how to run the tool gsid2mpr tool. The gsid2mpr tool reformats one or more GSI diagnostic files into an ASCII matched pair (MPR) format, similar to the MPR output of the Point-Stat tool. The output MPR data may be passed to the Stat-Analysis tool to compute a wide variety of continuous or categorical statistics.</p>
<div class="section" id="gsid2mpr-usage">
<h3><span class="section-number">11.1.1. </span>gsid2mpr usage<a class="headerlink" href="#gsid2mpr-usage" title="Permalink to this headline">¶</a></h3>
<p>The usage statement for the gsid2mpr tool is shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Usage: gsid2mpr
       gsi_file_1 [gsi_file_2 ... gsi_file_n]
       [-swap]
       [-no_check_dup]
       [-channel n]
       [-set_hdr col_name value]
       [-suffix string]
       [-outdir path]
       [-log file]
       [-v level]
</pre></div>
</div>
<p>gsid2mpr has one required argument and and accepts several optional ones.</p>
<div class="section" id="required-arguments-for-gsid2mpr">
<h4><span class="section-number">11.1.1.1. </span>Required arguments for gsid2mpr<a class="headerlink" href="#required-arguments-for-gsid2mpr" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>The <strong>gsi_file_1 [gsi_file2 … gsi_file_n]</strong> argument indicates the GSI diagnostic files (conventional or radiance) to be reformatted.</p></li>
</ol>
</div>
<div class="section" id="optional-arguments-for-gsid2mpr">
<h4><span class="section-number">11.1.1.2. </span>Optional arguments for gsid2mpr<a class="headerlink" href="#optional-arguments-for-gsid2mpr" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple" start="2">
<li><p>The <strong>-swap</strong> option switches the endianness when reading the input binary files.</p></li>
<li><p>The <strong>-no_check_dup</strong> option disables the checking for duplicate matched pairs which slows down the tool considerably for large files.</p></li>
<li><p>The <strong>-channel n</strong> option overrides the default processing of all radiance channels with the values of a comma-separated list.</p></li>
<li><p>The <strong>-set_hdr col_name value</strong> option specifies what should be written to the output header columns.</p></li>
<li><p>The <strong>-suffix string</strong> option overrides the default output filename suffix (.stat).</p></li>
<li><p>The <strong>-outdir path</strong> option overrides the default output directory (./).</p></li>
<li><p>The <strong>-log file</strong> option outputs log messages to the specified file.</p></li>
<li><p>The <strong>-v level</strong> option overrides the default level of logging (2).</p></li>
</ol>
<p>An example of the gsid2mpr calling sequence is shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gsid2mpr diag_conv_ges.mem001 \
-set_hdr MODEL GSI_MEM001 \
-outdir out
</pre></div>
</div>
<p>In this example, the gsid2mpr tool will process a single input file named <strong>diag_conv_ges.mem001</strong> file, set the output <strong>MODEL</strong> header column to <strong>GSI_MEM001</strong>, and write output to the <strong>out</strong> directory. The output file is named the same as the input file but a <strong>.stat</strong> suffix is added to indicate its format.</p>
</div>
</div>
<div class="section" id="gsid2mpr-output">
<h3><span class="section-number">11.1.2. </span>gsid2mpr output<a class="headerlink" href="#gsid2mpr-output" title="Permalink to this headline">¶</a></h3>
<p>The gsid2mpr tool performs a simple reformatting step and thus requires no configuration file. It can read both conventional and radiance binary GSI diagnostic files. Support for additional GSI diagnostic file type may be added in future releases. Conventional files are determined by the presence of the string <strong>conv</strong> in the filename. Files that are not conventional are assumed to contain radiance data. Multiple files of either type may be passed in a single call to the gsid2mpr tool. For each input file, an output file will be generated containing the corresponding matched pair data.</p>
<p>The gsid2mpr tool writes the same set of MPR output columns for the conventional and radiance data types. However, it also writes additional columns at the end of the MPR line which depend on the input file type. Those additional columns are described in the following tables.</p>
<table class="colwidths-auto docutils align-default" id="id2">
<caption><span class="caption-number">Table 11.1 </span><span class="caption-text">Format information for GSI Diagnostic Conventional MPR (Matched Pair) output line type.</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"></th>
<th class="head"><p>GSI DIAGNOSTIC CONVENTIONAL MPR OUTPUT FILE</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Column Number</p></th>
<th class="head"><p>Column Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1-37</p></td>
<td></td>
<td><p>Standard MPR columns described in <a class="reference internal" href="point-stat.html#table-ps-format-info-mpr"><span class="std std-numref">Table 7.20</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p>38</p></td>
<td><p>OBS_PRS</p></td>
<td><p>Model pressure value at the observation height (hPa)</p></td>
</tr>
<tr class="row-odd"><td><p>39</p></td>
<td><p>OBS_ERR_IN</p></td>
<td><p>PrepBUFR inverse observation error</p></td>
</tr>
<tr class="row-even"><td><p>40</p></td>
<td><p>OBS_ERR_ADJ</p></td>
<td><p>read_PrepBUFR inverse observation error</p></td>
</tr>
<tr class="row-odd"><td><p>41</p></td>
<td><p>OBS_ERR_FIN</p></td>
<td><p>Final inverse observation error</p></td>
</tr>
<tr class="row-even"><td><p>42</p></td>
<td><p>PREP_USE</p></td>
<td><p>read_PrepBUFR usage</p></td>
</tr>
<tr class="row-odd"><td><p>43</p></td>
<td><p>ANLY_USE</p></td>
<td><p>Analysis usage (1 for yes, -1 for no)</p></td>
</tr>
<tr class="row-even"><td><p>44</p></td>
<td><p>SETUP_QC</p></td>
<td><p>Setup quality control</p></td>
</tr>
<tr class="row-odd"><td><p>45</p></td>
<td><p>QC_WGHT</p></td>
<td><p>Non-linear quality control relative weight</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-auto docutils align-default" id="id3">
<caption><span class="caption-number">Table 11.2 </span><span class="caption-text">Format information for GSI Diagnostic Radiance MPR (Matched Pair) output line type.</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"></th>
<th class="head"><p>GSI DIAGNOSTIC RADIANCE MPR OUTPUT FILE</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Column Number</p></th>
<th class="head"><p>Column Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1-37</p></td>
<td></td>
<td><p>Standard MPR columns described in <a class="reference internal" href="point-stat.html#table-ps-format-info-mpr"><span class="std std-numref">Table 7.20</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p>38</p></td>
<td><p>CHAN_USE</p></td>
<td><p>Channel used (1 for yes, -1 for no)</p></td>
</tr>
<tr class="row-odd"><td><p>39</p></td>
<td><p>SCAN_POS</p></td>
<td><p>Sensor scan position</p></td>
</tr>
<tr class="row-even"><td><p>40</p></td>
<td><p>SAT_ZNTH</p></td>
<td><p>Satellite zenith angle (degrees)</p></td>
</tr>
<tr class="row-odd"><td><p>41</p></td>
<td><p>SAT_AZMTH</p></td>
<td><p>Satellite azimuth angle (degrees)</p></td>
</tr>
<tr class="row-even"><td><p>42</p></td>
<td><p>SUN_ZNTH</p></td>
<td><p>Solar zenith angle (degrees)</p></td>
</tr>
<tr class="row-odd"><td><p>43</p></td>
<td><p>SUN_AZMTH</p></td>
<td><p>Solar azimuth angle (degrees)</p></td>
</tr>
<tr class="row-even"><td><p>44</p></td>
<td><p>SUN_GLNT</p></td>
<td><p>Sun glint angle (degrees)</p></td>
</tr>
<tr class="row-odd"><td><p>45</p></td>
<td><p>FRAC_WTR</p></td>
<td><p>Fractional coverage by water</p></td>
</tr>
<tr class="row-even"><td><p>46</p></td>
<td><p>FRAC_LND</p></td>
<td><p>Fractional coverage by land</p></td>
</tr>
<tr class="row-odd"><td><p>47</p></td>
<td><p>FRAC_ICE</p></td>
<td><p>Fractional coverage by ice</p></td>
</tr>
<tr class="row-even"><td><p>48</p></td>
<td><p>FRAC_SNW</p></td>
<td><p>Fractional coverage by snow</p></td>
</tr>
<tr class="row-odd"><td><p>49</p></td>
<td><p>SFC_TWTR</p></td>
<td><p>Surface temperature over water (K)</p></td>
</tr>
<tr class="row-even"><td><p>50</p></td>
<td><p>SFC_TLND</p></td>
<td><p>Surface temperature over land (K)</p></td>
</tr>
<tr class="row-odd"><td><p>51</p></td>
<td><p>SFC_TICE</p></td>
<td><p>Surface temperature over ice (K)</p></td>
</tr>
<tr class="row-even"><td><p>52</p></td>
<td><p>SFC_TSNW</p></td>
<td><p>Surface temperature over snow (K)</p></td>
</tr>
<tr class="row-odd"><td><p>53</p></td>
<td><p>TSOIL</p></td>
<td><p>Soil temperature (K)</p></td>
</tr>
<tr class="row-even"><td><p>54</p></td>
<td><p>SOILM</p></td>
<td><p>Soil moisture</p></td>
</tr>
<tr class="row-odd"><td><p>55</p></td>
<td><p>LAND_TYPE</p></td>
<td><p>Surface land type</p></td>
</tr>
<tr class="row-even"><td><p>56</p></td>
<td><p>FRAC_VEG</p></td>
<td><p>Vegetation fraction</p></td>
</tr>
<tr class="row-odd"><td><p>57</p></td>
<td><p>SNW_DPTH</p></td>
<td><p>Snow depth</p></td>
</tr>
<tr class="row-even"><td><p>58</p></td>
<td><p>SFC_WIND</p></td>
<td><p>Surface wind speed (m/s)</p></td>
</tr>
<tr class="row-odd"><td><p>59</p></td>
<td><p>FRAC_CLD  CLD_LWC</p></td>
<td><p>Cloud fraction (%) <span class="raw-html"><br /></span>  Cloud liquid water (kg/m**2) (microwave only)</p></td>
</tr>
<tr class="row-even"><td><p>60</p></td>
<td><p>CTOP_PRS   TC_PWAT</p></td>
<td><p>Cloud top pressure (hPa) <span class="raw-html"><br /></span>  Total column precip. water (km/m**2) (microwave only)</p></td>
</tr>
<tr class="row-odd"><td><p>61</p></td>
<td><p>TFND</p></td>
<td><p>Foundation temperature: Tr</p></td>
</tr>
<tr class="row-even"><td><p>62</p></td>
<td><p>TWARM</p></td>
<td><p>Diurnal warming: d(Tw) at depth zob</p></td>
</tr>
<tr class="row-odd"><td><p>63</p></td>
<td><p>TCOOL</p></td>
<td><p>Sub-layer cooling: d(Tc) at depth zob</p></td>
</tr>
<tr class="row-even"><td><p>64</p></td>
<td><p>TZFND</p></td>
<td><p>d(Tz)/d(Tr)</p></td>
</tr>
<tr class="row-odd"><td><p>65</p></td>
<td><p>OBS_ERR</p></td>
<td><p>Inverse observation error</p></td>
</tr>
<tr class="row-even"><td><p>66</p></td>
<td><p>FCST_NOBC</p></td>
<td><p>Brightness temperature with no bias correction (K)</p></td>
</tr>
<tr class="row-odd"><td><p>67</p></td>
<td><p>SFC_EMIS</p></td>
<td><p>Surface emissivity</p></td>
</tr>
<tr class="row-even"><td><p>68</p></td>
<td><p>STABILITY</p></td>
<td><p>Stability index</p></td>
</tr>
<tr class="row-odd"><td><p>69</p></td>
<td><p>PRS_MAX_WGT</p></td>
<td><p>Pressure of the maximum weighing function</p></td>
</tr>
</tbody>
</table>
<p>The gsid2mpr output may be passed to the Stat-Analysis tool to derive additional statistics. In particular, users should consider running the <strong>aggregate_stat</strong> job type to read MPR lines and compute partial sums (SL1L2), continuous statistics (CNT), contingency table counts (CTC), or contingency table statistics (CTS). Stat-Analysis has been enhanced to parse any extra columns found at the end of the input lines. Users can filter the values in those extra columns using the <strong>-column_thresh</strong> and <strong>-column_str</strong> job command options.</p>
<p>An example of the Stat-Analysis calling sequence is shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stat_analysis -lookin diag_conv_ges.mem001.stat \
-job aggregate_stat -line_type MPR -out_line_type CNT \
-fcst_var t -column_thresh ANLY_USE eq1
</pre></div>
</div>
<p>In this example, the Stat-Analysis tool will read MPR lines from the input file named <strong>diag_conv_ges.mem001.stat</strong>, retain only those lines where the <strong>FCST_VAR</strong> column indicates temperature (<strong>t</strong>) and where the <strong>ANLY_USE</strong> column has a value of 1.0, and derive continuous statistics.</p>
</div>
</div>
<div class="section" id="gsidens2orank-tool">
<h2><span class="section-number">11.2. </span>GSIDENS2ORANK tool<a class="headerlink" href="#gsidens2orank-tool" title="Permalink to this headline">¶</a></h2>
<p>This section describes how to run the gsidens2orank tool. The gsidens2orank tool processes an ensemble of GSI diagnostic files and reformats them into the MET observation rank (ORANK) line type, similar to the output of the Ensemble-Stat tool. The ORANK line type contains ensemble matched pair information and is analogous to the MPR line type for a deterministic model. The output ORANK data may be passed to the Stat-Analysis tool to compute ensemble statistics.</p>
<div class="section" id="gsidens2orank-usage">
<h3><span class="section-number">11.2.1. </span>gsidens2orank usage<a class="headerlink" href="#gsidens2orank-usage" title="Permalink to this headline">¶</a></h3>
<p>The usage statement for the gsidens2orank tool is shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Usage: gsidens2orank
       ens_file_1 ... ens_file_n | ens_file_list
       -out path
       [-ens_mean path]
       [-swap]
       [-rng_name str]
       [-rng_seed str]
       [-set_hdr col_name value]
       [-log file]
       [-v level]
</pre></div>
</div>
<p>gsidens2orank has three required arguments and accepts several optional ones.</p>
<div class="section" id="required-arguments-for-gsidens2orank">
<h4><span class="section-number">11.2.1.1. </span>Required arguments for gsidens2orank<a class="headerlink" href="#required-arguments-for-gsidens2orank" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li><p>The <strong>ens_file_1 … ens_file_n</strong> argument is a list of ensemble binary GSI diagnostic files to be reformatted.</p></li>
<li><p>The <strong>ens_file_list</strong> argument is an ASCII file containing a list of ensemble GSI diagnostic files.</p></li>
<li><p>The <strong>-out path</strong> argument specifies the name of the output <strong>.stat</strong> file.</p></li>
</ol>
</div>
<div class="section" id="optional-arguments-for-gsidens2orank">
<h4><span class="section-number">11.2.1.2. </span>Optional arguments for gsidens2orank<a class="headerlink" href="#optional-arguments-for-gsidens2orank" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple" start="4">
<li><p>The <strong>-ens_mean path</strong> option is the ensemble mean binary GSI diagnostic file.</p></li>
<li><p>The <strong>-swap</strong> option switches the endianness when reading the input binary files.</p></li>
<li><p>The <strong>-channel n</strong> option overrides the default processing of all radiance channels with a comma-separated list.</p></li>
<li><p>The <strong>-rng_name str</strong> option overrides the default random number generator name (mt19937).</p></li>
<li><p>The <strong>-rng_seed str</strong> option overrides the default random number generator seed.</p></li>
<li><p>The <strong>-set_hdr col_name value</strong> option specifies what should be written to the output header columns.</p></li>
<li><p>The <strong>-log file</strong> option outputs log messages to the specified file.</p></li>
<li><p>The <strong>-v level</strong> option overrides the default level of logging (2).</p></li>
</ol>
<p>An example of the gsidens2orank calling sequence is shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>gsidens2orank diag_conv_ges.mem* \
-ens_mean diag_conv_ges.ensmean \
-out diag_conv_ges_ens_mean_orank.txt
</pre></div>
</div>
<p>In this example, the gsidens2orank tool will process all of the ensemble members whose file name <strong>matches diag_conv_ges.mem*,</strong> write output to the file named <strong>diag_conv_ges_ens_mean_orank.txt</strong>, and populate the output <strong>ENS_MEAN</strong> column with the values found in the <strong>diag_conv_ges.ensmean</strong> file rather than computing the ensemble mean values from the ensemble members on the fly.</p>
</div>
</div>
<div class="section" id="gsidens2orank-output">
<h3><span class="section-number">11.2.2. </span>gsidens2orank output<a class="headerlink" href="#gsidens2orank-output" title="Permalink to this headline">¶</a></h3>
<p>The gsidens2orank tool performs a simple reformatting step and thus requires no configuration file. The multiple files passed to it are interpreted as members of the same ensemble. Therefore, each call to the tool processes exactly one ensemble. All input ensemble GSI diagnostic files must be of the same type. Mixing conventional and radiance files together will result in a runtime error. The gsidens2orank tool processes each ensemble member and keeps track of the observations it encounters. It constructs a list of the ensemble values corresponding to each observation and writes an output ORANK line listing the observation value, its rank, and all the ensemble values. The random number generator is used by the gsidens2orank tool to randomly assign a rank value in the case of ties.</p>
<p>The gsid2mpr tool writes the same set of ORANK output columns for the conventional and radiance data types. However, it also writes additional columns at the end of the ORANK line which depend on the input file type. The extra columns are limited to quantities which remain constant over all the ensemble members and are therefore largely a subset of the extra columns written by the gsid2mpr tool. Those additional columns are described in the following tables.</p>
<table class="colwidths-auto docutils align-default" id="id4">
<caption><span class="caption-number">Table 11.3 </span><span class="caption-text">Format information for GSI Diagnostic Conventional ORANK (Observation Rank) output line type.</span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"></th>
<th class="head"><p>GSI DIAGNOSTIC CONVENTIONAL ORANK OUTPUT FILE</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Column Number</p></th>
<th class="head"><p>Column Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1-?</p></td>
<td></td>
<td><p>Standard ORANK columns described in <a class="reference internal" href="ensemble-stat.html#table-es-header-info-es-out-orank"><span class="std std-numref">Table 9.7</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p>Last-2</p></td>
<td><p>N_USE</p></td>
<td><p>Number of members with ANLY_USE = 1</p></td>
</tr>
<tr class="row-odd"><td><p>Last-1</p></td>
<td><p>PREP_USE</p></td>
<td><p>read_PrepBUFR usage</p></td>
</tr>
<tr class="row-even"><td><p>Last</p></td>
<td><p>SETUP_QC</p></td>
<td><p>Setup quality control</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-auto docutils align-default" id="id5">
<caption><span class="caption-number">Table 11.4 </span><span class="caption-text">Format information for GSI Diagnostic Radiance ORANK (Observation Rank) output line type.</span><a class="headerlink" href="#id5" title="Permalink to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"></th>
<th class="head"><p>GSI DIAGNOSTIC RADIANCE ORANK OUTPUT FILE</p></th>
</tr>
<tr class="row-even"><th class="head"><p>Column Number</p></th>
<th class="head"><p>Column Name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-odd"><td><p>1-?</p></td>
<td></td>
<td><p>Standard ORANK columns described in <a class="reference internal" href="ensemble-stat.html#table-es-header-info-es-out-orank"><span class="std std-numref">Table 9.7</span></a>.</p></td>
</tr>
<tr class="row-even"><td><p>Last-24</p></td>
<td><p>N_USE</p></td>
<td><p>Number of members with OBS_QC = 0</p></td>
</tr>
<tr class="row-odd"><td><p>Last-23</p></td>
<td><p>CHAN_USE</p></td>
<td><p>Channel used (1 for yes, -1 for no)</p></td>
</tr>
<tr class="row-even"><td><p>Last-22</p></td>
<td><p>SCAN_POS</p></td>
<td><p>Sensor scan position</p></td>
</tr>
<tr class="row-odd"><td><p>Last-21</p></td>
<td><p>SAT_ZNTH</p></td>
<td><p>Satellite zenith angle (degrees)</p></td>
</tr>
<tr class="row-even"><td><p>Last-20</p></td>
<td><p>SAT_AZMTH</p></td>
<td><p>Satellite azimuth angle (degrees)</p></td>
</tr>
<tr class="row-odd"><td><p>Last-19</p></td>
<td><p>SUN_ZNTH</p></td>
<td><p>Solar zenith angle (degrees)</p></td>
</tr>
<tr class="row-even"><td><p>Last-18</p></td>
<td><p>SUN_AZMTH</p></td>
<td><p>Solar azimuth angle (degrees)</p></td>
</tr>
<tr class="row-odd"><td><p>Last-17</p></td>
<td><p>SUN_GLNT</p></td>
<td><p>Sun glint angle (degrees)</p></td>
</tr>
<tr class="row-even"><td><p>Last-16</p></td>
<td><p>FRAC_WTR</p></td>
<td><p>Fractional coverage by water</p></td>
</tr>
<tr class="row-odd"><td><p>Last-15</p></td>
<td><p>FRAC_LND</p></td>
<td><p>Fractional coverage by land</p></td>
</tr>
<tr class="row-even"><td><p>Last-14</p></td>
<td><p>FRAC_ICE</p></td>
<td><p>Fractional coverage by ice</p></td>
</tr>
<tr class="row-odd"><td><p>Last-13</p></td>
<td><p>FRAC_SNW</p></td>
<td><p>Fractional coverage by snow</p></td>
</tr>
<tr class="row-even"><td><p>Last-12</p></td>
<td><p>SFC_TWTR</p></td>
<td><p>Surface temperature over water (K)</p></td>
</tr>
<tr class="row-odd"><td><p>Last-11</p></td>
<td><p>SFC_TLND</p></td>
<td><p>Surface temperature over land (K)</p></td>
</tr>
<tr class="row-even"><td><p>Last-10</p></td>
<td><p>SFC_TICE</p></td>
<td><p>Surface temperature over ice (K)</p></td>
</tr>
<tr class="row-odd"><td><p>Last-9</p></td>
<td><p>SFC_TSNW</p></td>
<td><p>Surface temperature over snow (K)</p></td>
</tr>
<tr class="row-even"><td><p>Last-8</p></td>
<td><p>TSOIL</p></td>
<td><p>Soil temperature (K)</p></td>
</tr>
<tr class="row-odd"><td><p>Last-7</p></td>
<td><p>SOILM</p></td>
<td><p>Soil moisture</p></td>
</tr>
<tr class="row-even"><td><p>Last-6</p></td>
<td><p>LAND_TYPE</p></td>
<td><p>Surface land type</p></td>
</tr>
<tr class="row-odd"><td><p>Last-5</p></td>
<td><p>FRAC_VEG</p></td>
<td><p>Vegetation fraction</p></td>
</tr>
<tr class="row-even"><td><p>Last-4</p></td>
<td><p>SNW_DPTH</p></td>
<td><p>Snow depth</p></td>
</tr>
<tr class="row-odd"><td><p>Last-3</p></td>
<td><p>TFND</p></td>
<td><p>Foundation temperature: Tr</p></td>
</tr>
<tr class="row-even"><td><p>Last-2</p></td>
<td><p>TWARM</p></td>
<td><p>Diurnal warming: d(Tw) at depth zob</p></td>
</tr>
<tr class="row-odd"><td><p>Last-1</p></td>
<td><p>TCOOL</p></td>
<td><p>Sub-layer cooling: d(Tc) at depth zob</p></td>
</tr>
<tr class="row-even"><td><p>Last</p></td>
<td><p>TZFND</p></td>
<td><p>d(Tz)/d(Tr)</p></td>
</tr>
</tbody>
</table>
<p>The gsidens2orank output may be passed to the Stat-Analysis tool to derive additional statistics. In particular, users should consider running the <strong>aggregate_stat</strong> job type to read ORANK lines and ranked histograms (RHIST), probability integral transform histograms (PHIST), and spread-skill variance output (SSVAR). Stat-Analysis has been enhanced to parse any extra columns found at the end of the input lines. Users can filter the values in those extra columns using the <strong>-column_thresh</strong> and <strong>-column_str</strong> job command options.</p>
<p>An example of the Stat-Analysis calling sequence is shown below:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>stat_analysis -lookin diag_conv_ges_ens_mean_orank.txt \
-job aggregate_stat -line_type ORANK -out_line_type RHIST \
-by fcst_var -column_thresh N_USE eq20
</pre></div>
</div>
<p>In this example, the Stat-Analysis tool will read ORANK lines from <strong>diag_conv_ges_ens_mean_orank.txt</strong>, retain only those lines where the <strong>N_USE</strong> column indicates that all 20 ensemble members were used, and write ranked histogram (RHIST) output lines for each unique value of encountered in the <strong>FCST_VAR</strong> column.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="stat-analysis.html" class="btn btn-neutral float-right" title="12. Stat-Analysis Tool" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="wavelet-stat.html" class="btn btn-neutral" title="10. Wavelet-Stat Tool" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, UCAR/NCAR, NOAA, and CSU/CIRA.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
     
<script>var version_json_loc = "../../versions.json";</script>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'develop',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="../_static/pop_ver.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>